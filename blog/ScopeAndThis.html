<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>作用域 | zsn的前端日志</title>
    <meta name="description" content="欢迎访问我的前端日志">
    
    
    <link rel="preload" href="/MyBlog/assets/css/0.styles.6e789ea6.css" as="style"><link rel="preload" href="/MyBlog/assets/js/app.0e286d4e.js" as="script"><link rel="preload" href="/MyBlog/assets/js/2.7e911cb8.js" as="script"><link rel="preload" href="/MyBlog/assets/js/8.1da0f733.js" as="script"><link rel="prefetch" href="/MyBlog/assets/js/10.99a904a5.js"><link rel="prefetch" href="/MyBlog/assets/js/11.ac949971.js"><link rel="prefetch" href="/MyBlog/assets/js/12.c31501ec.js"><link rel="prefetch" href="/MyBlog/assets/js/13.95e2f57e.js"><link rel="prefetch" href="/MyBlog/assets/js/14.d640b35c.js"><link rel="prefetch" href="/MyBlog/assets/js/15.c2a1b5f2.js"><link rel="prefetch" href="/MyBlog/assets/js/16.698f4be3.js"><link rel="prefetch" href="/MyBlog/assets/js/17.f8d6f673.js"><link rel="prefetch" href="/MyBlog/assets/js/18.15b86135.js"><link rel="prefetch" href="/MyBlog/assets/js/3.b50c28e0.js"><link rel="prefetch" href="/MyBlog/assets/js/4.c4832647.js"><link rel="prefetch" href="/MyBlog/assets/js/5.cf7ec021.js"><link rel="prefetch" href="/MyBlog/assets/js/6.48e550eb.js"><link rel="prefetch" href="/MyBlog/assets/js/7.bc350bb7.js"><link rel="prefetch" href="/MyBlog/assets/js/9.b5edd05a.js">
    <link rel="stylesheet" href="/MyBlog/assets/css/0.styles.6e789ea6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/MyBlog/" class="home-link router-link-active"><!----> <span class="site-name">zsn的前端日志</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/MyBlog/blog/" class="nav-link router-link-active">博客</a></div><div class="nav-item"><a href="/MyBlog/interview/" class="nav-link">面试题</a></div><div class="nav-item"><a href="/MyBlog/book/" class="nav-link">阅读</a></div> <a href="https://github.com/ZSN1024/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/MyBlog/blog/" class="nav-link router-link-active">博客</a></div><div class="nav-item"><a href="/MyBlog/interview/" class="nav-link">面试题</a></div><div class="nav-item"><a href="/MyBlog/book/" class="nav-link">阅读</a></div> <a href="https://github.com/ZSN1024/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Devops</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>javascript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/MyBlog/blog/ScopeAndThis.html" class="active sidebar-link">作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MyBlog/blog/ScopeAndThis.html#作用域" class="sidebar-link">作用域</a></li><li class="sidebar-sub-header"><a href="/MyBlog/blog/ScopeAndThis.html#this" class="sidebar-link">this</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>typescript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/MyBlog/blog/ts_description.html" class="sidebar-link">TypeScript 简介</a></li><li><a href="/MyBlog/blog/ts_basic.html" class="sidebar-link">TypeScript 基础</a></li><li><a href="/MyBlog/blog/ts_advanced.html" class="sidebar-link">TypeScript 进阶</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="作用域"><a href="#作用域" class="header-anchor">#</a> 作用域</h2> <h3 id="作用域概述"><a href="#作用域概述" class="header-anchor">#</a> 作用域概述</h3> <p>作用域是代码在运行时某些特定部分中的变量与函数的可访问性。</p> <p>作用域决定了变量与函数的可访问范围，即作用域控制着变量与函数的可见性和生命周期</p> <p><img src="/MyBlog/blog/scope.jpg" alt="作用域"></p> <p>ES5中只有全局作用域和函数作用域，我们都知道他没有块级作用域。</p> <p>ES6中多了一个let，他可以保证外层块不受内层块的影响。即内层块形成了一个块级作用域，这是let的一个特点。</p> <p>函数的内部环境可以通过作用域链访问到所有的外部环境，但是外部环境却不可以访问外部环境，这就是作用域的关键。但是我们要知道，作用域是在一个函数创建时就已经形成的，而不是调用时。</p> <h3 id="作用域链"><a href="#作用域链" class="header-anchor">#</a> 作用域链</h3> <p>一般情况，变量取值是到创建这个变量的函数的作用域中取值。那在函数作用域中取不到怎么办？</p> <p>如果在当前作用域中没有查到值，就会向上级作用域去查，直到查到全局作用域，这么一个查找过程形成的链条就叫做作用域链。</p> <h3 id="var、let、const的区别"><a href="#var、let、const的区别" class="header-anchor">#</a> var、let、const的区别</h3> <p>var定义的变量，没有块的概念，可以跨块访问, 不能跨函数访问。</p> <p>let定义的变量，只能在块作用域里访问，不能跨块访问，也不能跨函数访问。</p> <p>const用来定义常量，使用时必须初始化(即必须赋值)，只能在块作用域里访问，而且不能修改</p> <p>那什么是块？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><p>这都是块</p> <p>三者还有其他区别吗？</p> <h3 id="声明提升"><a href="#声明提升" class="header-anchor">#</a> 声明提升</h3> <p>大部分编程语言都是先声明变量再使用，否则会报错。但在js中，则会变的不一样。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p>结果是undefined，不会报错</p> <p>变量声明，不管在哪里发生（声明），都会在任意代码执行前处理.</p> <p>以var声明的变量的作用域就是当前执行上下文，即某个函数，或者全局作用域（声明在函数外）。</p> <h3 id="函数定义"><a href="#函数定义" class="header-anchor">#</a> 函数定义</h3> <p>定义一个函数有两种方式：函数声明和函数表达式</p> <p>区别？</p> <p><img src="/MyBlog/blog/fn.jpg" alt="函数定义"></p> <p>函数声明会有声明提升
函数表达式不会有声明提示</p> <p>既然变量和函数声明都有提升，先提升谁呢？我们来看一个例子</p> <p><img src="/MyBlog/blog/example.jpg" alt="例子"></p> <p>静静的思考两分钟。。。</p> <p>然后看结果
<img src="/MyBlog/blog/answer.jpg" alt="答案"></p> <p>然而，why？</p> <p>首先说当定义的变量名和函数的参数名重复的时候，变量定义会失效，不会覆盖函数的参数。</p> <p>再者，函数的定义优先级高于变量的定义，所以后面同名的变量定义会失效。
但是赋值是有效的</p> <h2 id="this"><a href="#this" class="header-anchor">#</a> this</h2> <p>我们先来看一道题</p> <p><img src="/MyBlog/blog/this.jpg" alt="this"></p> <p>有答案了吗？结果我们先不说答案，继续看下去</p> <p>this关键字是JavaScript中最复杂的机制之一，This其实 就是一个指针，指向调用函数的对象</p> <p>为了能够准确的知道this指向的是什么，我们需要了解this的绑定规则有哪些</p> <ul><li>默认绑定</li> <li>隐式绑定</li> <li>硬(显示)绑定</li> <li>new绑定</li></ul> <h3 id="默认绑定"><a href="#默认绑定" class="header-anchor">#</a> 默认绑定</h3> <p>默认绑定，在不能应用其它绑定规则时使用的默认规则，通常是独立函数调用。</p> <p><img src="/MyBlog/blog/bangding1.jpg" alt="默认"></p> <p>如果在浏览器环境中运行，那么结果就是 Hello,wejoydata
但是如果在node环境中运行，结果就是 Hello,undefined</p> <h3 id="隐式绑定"><a href="#隐式绑定" class="header-anchor">#</a> 隐式绑定</h3> <p>函数的调用是在某个对象上触发的，即调用位置上存在上下文对象。典型的形式为 XXX.fun()</p> <p><img src="/MyBlog/blog/bangding2.jpg" alt="默认"></p> <p>现在我们来思考一个问题，多个对象多层调用会是什么样的？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'wejoydata'</span><span class="token punctuation">,</span>
  sayHi<span class="token punctuation">:</span> sayHi
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'future'</span><span class="token punctuation">,</span>
  friend<span class="token punctuation">:</span> person2
<span class="token punctuation">}</span>
person1<span class="token punctuation">.</span>friend<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>结果是： Hello, wejoydata</p> <p>为什么呢？
只有最后一层调用才会确定this指向的是什么，所以我们只需要关注最后一层，即此处的friend。</p> <p><code>隐式绑定有一个大坑，让我们以为的正确绑定是错的.</code></p> <p>再来看一段代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'wejoydata'</span><span class="token punctuation">,</span>
  sayHi<span class="token punctuation">:</span> sayHi
<span class="token punctuation">}</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'future'</span>
<span class="token keyword">var</span> Hi <span class="token operator">=</span> person<span class="token punctuation">.</span>sayHi<span class="token punctuation">;</span>
<span class="token function">Hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>结果是啥呢？</p> <p>Hello, future</p> <p>Why?</p> <p>Hi直接指向了sayHi的引用，在调用的时候，跟person没有半毛钱的关系，针对此类问题，我建议大家只需牢牢记住这个格式:XXX.fn();</p> <p>fn()前如果什么都没有，那么肯定不是隐式绑定</p> <p>再来看一段代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello,'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'quyong'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayHi</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello,'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'future'</span><span class="token punctuation">,</span>
  sayHi<span class="token punctuation">:</span> sayHi
<span class="token punctuation">}</span>
<span class="token keyword">var</span> name<span class="token operator">=</span><span class="token string">'wejoydata'</span><span class="token punctuation">;</span>
person1<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>person2<span class="token punctuation">.</span>sayHi<span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  person2<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这个的结果是啥呢？</p> <p>Hello, wejoydata</p> <p>Hello, wejoydata</p> <p>Hello, future</p> <p>Why?</p> <p>第一条输出很容易理解，setTimeout的回调函数中，this使用的是默认绑定，非严格模式下，执行的是全局对象</p> <p>第二条输出，说好的XXX.fun()的时候，fun中的this指向的是XXX呢，为什么这次却不是这样了！Why?</p> <p>其实这里我们可以这样理解: setTimeout(fn,delay){ fn(); },相当于是将person2.sayHi赋值给了一个变量，最后执行了变量，这个时候，sayHi中的this显然和person2就没有关系了。</p> <p>第三条虽然也是在setTimeout的回调中，但是我们可以看出，这是执行的是person2.sayHi()使用的是隐式绑定，因此这是this指向的是person2，跟当前的作用域没有任何关系。</p> <h3 id="硬绑定-显示绑定"><a href="#硬绑定-显示绑定" class="header-anchor">#</a> 硬绑定(显示绑定)</h3> <p>显式绑定比较好理解，就是通过call,apply,bind的方式，显式的指定this所指向的对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello,'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'wejoydata'</span><span class="token punctuation">,</span>
  sayHi<span class="token punctuation">:</span> sayHi
<span class="token punctuation">}</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'future'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> Hi <span class="token operator">=</span> person<span class="token punctuation">.</span>sayHi<span class="token punctuation">;</span>
<span class="token function">Hi</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>结果大家应该都知道是 Hello, wejoydata</p> <p>那么，显示绑定会有隐式绑定的坑吗？</p> <p>我们来看代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello,'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'wejoydata'</span><span class="token punctuation">,</span>
  sayHi<span class="token punctuation">:</span> sayHi
<span class="token punctuation">}</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'future'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">Hi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">Hi</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> sayHi<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>结果是啥，大家思考一下</p> <p>Hello, future</p> <p>why?明明通过call改变了this指向啊</p> <p>再看下面这段代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello,'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'wejoydata'</span><span class="token punctuation">,</span>
  sayHi<span class="token punctuation">:</span> sayHi
<span class="token punctuation">}</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'future'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">Hi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">Hi</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> sayHi<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这样就是你想的答案了</p> <h3 id="new绑定"><a href="#new绑定" class="header-anchor">#</a> new绑定</h3> <p>Js中并没有类，构造函数只是使用new操作符时被调用的函数，和普通函数并没有什么不同。任何一个函数都可以使用new来调用，此时会执行以下操作：</p> <p>1、创建一个空对象，构造函数中的this指向这个空对象</p> <p>2、将对象与构造函数进行原型链接</p> <p>3、执行构造函数方法，属性和方法被添加到this引用的对象中</p> <p>4、如果构造函数中没有返回其它对象，那么返回this，即创建的这个的新对象，否则，返回构造函数中返回的对象。</p> <p>我们来看new如何改变this的指向的</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> target <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
  <span class="token keyword">let</span> <span class="token punctuation">[</span>constructor<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">;</span>
  target<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> constructor<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">constructor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> target<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
<span class="token keyword">var</span> Hi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">sayHi</span><span class="token punctuation">(</span><span class="token string">'wejoydata'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Hi<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello,'</span><span class="token punctuation">,</span> Hi<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这样大家应该都理解了</p> <p>四种绑定规则有一个优先级需要记住</p> <p>new绑定 &gt; 显式绑定 &gt; 隐式绑定 &gt; 默认绑定</p> <p>到这里this的绑定我们就讲完了，回顾一开始的题，大家来自己做一下吧</p> <p>答案给到大家</p> <p>10 9 3 27 20</p> <p>你做对了吗？</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/6/2019, 8:30:40 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/MyBlog/blog/learn.html" class="prev">todo</a></span> <span class="next"><a href="/MyBlog/blog/ts_description.html">TypeScript 简介</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/MyBlog/assets/js/app.0e286d4e.js" defer></script><script src="/MyBlog/assets/js/2.7e911cb8.js" defer></script><script src="/MyBlog/assets/js/8.1da0f733.js" defer></script>
  </body>
</html>
